<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
  import { getFirestore, collection, getDocs, query, where } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyBteqOTPNw-jdFLelhiwIxUfmFXMJr6lmI",
    authDomain: "quiet-wordsz.firebaseapp.com",
    projectId: "quiet-wordsz",
    storageBucket: "quiet-wordsz.appspot.com",
    messagingSenderId: "1091680546012",
    appId: "1:1091680546012:web:4bf9c7401303fa29349819"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  async function getQuote() {
    const situation = document.getElementById("situation").value;
    const q = query(collection(db, "quotes"), where("category", "==", situation));
    const querySnapshot = await getDocs(q);

    const results = [];
    querySnapshot.forEach((doc) => {
      results.push(doc.data().text);
    });

    if (results.length === 0) {
      document.getElementById("quote").innerText =
        "No quotes yet for this category.";
      return;
    }

    const randomIndex = Math.floor(Math.random() * results.length);
    document.getElementById("quote").innerText = results[randomIndex];
  }

  window.getQuote = getQuote;

  window.describeHer = function () {
    const mood = document.getElementById("herMood").value.trim();
    const nature = document.getElementById("herNature").value.trim();

    if (!mood && !nature) {
      document.getElementById("quote").innerText =
        "She doesn’t need definition to be felt.";
      return;
    }

    const templates = [
      `She feels ${mood || "unspoken"} today, and her ${nature || "presence"} makes even quiet moments feel meaningful.`,
      `There’s something ${nature || "rare"} about her — even when she’s ${mood || "silent"}, she leaves an impression.`,
      `She carries ${mood || "stillness"} softly, and her ${nature || "way of being"} feels honest.`,
      `Her ${nature || "energy"} shows most when she’s ${mood || "not trying"} — that’s where her beauty lives.`,
      `She doesn’t announce herself; her ${nature || "depth"} is felt, especially when she’s ${mood || "lost in thought"}.`
    ];

    const line = templates[Math.floor(Math.random() * templates.length)];
    document.getElementById("quote").innerText = line;
  };
</script>
